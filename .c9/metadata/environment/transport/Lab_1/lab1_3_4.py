{"filter":false,"title":"lab1_3_4.py","tooltip":"/transport/Lab_1/lab1_3_4.py","ace":{"folds":[],"scrolltop":4012.5,"scrollleft":0,"selection":{"start":{"row":282,"column":10},"end":{"row":282,"column":10},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":39,"state":"start","mode":"ace/mode/python"}},"hash":"95407fc637be7c6bb76395a297c2bf83a5a54a3e","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":242,"column":0},"end":{"row":244,"column":0},"action":"remove","lines":["# Define query to extract database info for the city of Madrid","",""],"id":106},{"start":{"row":241,"column":0},"end":{"row":242,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":229,"column":10},"end":{"row":229,"column":11},"action":"remove","lines":[" "],"id":107},{"start":{"row":229,"column":9},"end":{"row":229,"column":10},"action":"remove","lines":["a"]},{"start":{"row":229,"column":8},"end":{"row":229,"column":9},"action":"remove","lines":[" "]}],[{"start":{"row":229,"column":8},"end":{"row":229,"column":9},"action":"insert","lines":[" "],"id":108}],[{"start":{"row":229,"column":13},"end":{"row":229,"column":19},"action":"remove","lines":["ionary"],"id":109}],[{"start":{"row":229,"column":13},"end":{"row":229,"column":14},"action":"insert","lines":[" "],"id":110},{"start":{"row":229,"column":14},"end":{"row":229,"column":15},"action":"insert","lines":["f"]},{"start":{"row":229,"column":15},"end":{"row":229,"column":16},"action":"insert","lines":["o"]},{"start":{"row":229,"column":16},"end":{"row":229,"column":17},"action":"insert","lines":["r"]}],[{"start":{"row":229,"column":17},"end":{"row":229,"column":18},"action":"insert","lines":[" "],"id":111},{"start":{"row":229,"column":18},"end":{"row":229,"column":19},"action":"insert","lines":["e"]},{"start":{"row":229,"column":19},"end":{"row":229,"column":20},"action":"insert","lines":["a"]},{"start":{"row":229,"column":20},"end":{"row":229,"column":21},"action":"insert","lines":["c"]},{"start":{"row":229,"column":21},"end":{"row":229,"column":22},"action":"insert","lines":["h"]}],[{"start":{"row":229,"column":22},"end":{"row":229,"column":23},"action":"insert","lines":[" "],"id":112},{"start":{"row":229,"column":23},"end":{"row":229,"column":24},"action":"insert","lines":["c"]},{"start":{"row":229,"column":24},"end":{"row":229,"column":25},"action":"insert","lines":["i"]},{"start":{"row":229,"column":25},"end":{"row":229,"column":26},"action":"insert","lines":["t"]},{"start":{"row":229,"column":26},"end":{"row":229,"column":27},"action":"insert","lines":["y"]}],[{"start":{"row":254,"column":0},"end":{"row":256,"column":22},"action":"remove","lines":["# Define query to extract database info for the city of New York City","","listNYC = list(resNYC)"],"id":113},{"start":{"row":253,"column":0},"end":{"row":254,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":253,"column":0},"end":{"row":254,"column":0},"action":"insert","lines":["",""],"id":114},{"start":{"row":254,"column":0},"end":{"row":254,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":254,"column":1},"end":{"row":254,"column":2},"action":"insert","lines":[" "],"id":115},{"start":{"row":254,"column":2},"end":{"row":254,"column":3},"action":"insert","lines":["N"]},{"start":{"row":254,"column":3},"end":{"row":254,"column":4},"action":"insert","lines":["e"]},{"start":{"row":254,"column":4},"end":{"row":254,"column":5},"action":"insert","lines":["w"]}],[{"start":{"row":254,"column":5},"end":{"row":254,"column":6},"action":"insert","lines":[" "],"id":116},{"start":{"row":254,"column":6},"end":{"row":254,"column":7},"action":"insert","lines":["Y"]},{"start":{"row":254,"column":7},"end":{"row":254,"column":8},"action":"insert","lines":["o"]},{"start":{"row":254,"column":8},"end":{"row":254,"column":9},"action":"insert","lines":["r"]},{"start":{"row":254,"column":9},"end":{"row":254,"column":10},"action":"insert","lines":["k"]}],[{"start":{"row":254,"column":10},"end":{"row":254,"column":11},"action":"insert","lines":[" "],"id":117},{"start":{"row":254,"column":11},"end":{"row":254,"column":12},"action":"insert","lines":["I"]},{"start":{"row":254,"column":12},"end":{"row":254,"column":13},"action":"insert","lines":["C"]},{"start":{"row":254,"column":13},"end":{"row":254,"column":14},"action":"insert","lines":["t"]},{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"insert","lines":["y"]}],[{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"remove","lines":["y"],"id":118},{"start":{"row":254,"column":13},"end":{"row":254,"column":14},"action":"remove","lines":["t"]},{"start":{"row":254,"column":12},"end":{"row":254,"column":13},"action":"remove","lines":["C"]},{"start":{"row":254,"column":11},"end":{"row":254,"column":12},"action":"remove","lines":["I"]}],[{"start":{"row":254,"column":11},"end":{"row":254,"column":12},"action":"insert","lines":["C"],"id":119},{"start":{"row":254,"column":12},"end":{"row":254,"column":13},"action":"insert","lines":["i"]},{"start":{"row":254,"column":13},"end":{"row":254,"column":14},"action":"insert","lines":["t"]},{"start":{"row":254,"column":14},"end":{"row":254,"column":15},"action":"insert","lines":["y"]}],[{"start":{"row":241,"column":0},"end":{"row":241,"column":1},"action":"insert","lines":["#"],"id":120}],[{"start":{"row":241,"column":1},"end":{"row":241,"column":2},"action":"insert","lines":[" "],"id":121},{"start":{"row":241,"column":2},"end":{"row":241,"column":3},"action":"insert","lines":["M"]},{"start":{"row":241,"column":3},"end":{"row":241,"column":4},"action":"insert","lines":["a"]},{"start":{"row":241,"column":4},"end":{"row":241,"column":5},"action":"insert","lines":["d"]},{"start":{"row":241,"column":5},"end":{"row":241,"column":6},"action":"insert","lines":["r"]},{"start":{"row":241,"column":6},"end":{"row":241,"column":7},"action":"insert","lines":["i"]},{"start":{"row":241,"column":7},"end":{"row":241,"column":8},"action":"insert","lines":["d"]}],[{"start":{"row":240,"column":44},"end":{"row":241,"column":0},"action":"insert","lines":["",""],"id":122},{"start":{"row":241,"column":0},"end":{"row":241,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":229,"column":109},"end":{"row":230,"column":0},"action":"insert","lines":["",""],"id":123},{"start":{"row":230,"column":0},"end":{"row":230,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":230,"column":1},"end":{"row":230,"column":2},"action":"insert","lines":[" "],"id":124},{"start":{"row":230,"column":2},"end":{"row":230,"column":3},"action":"insert","lines":["T"]},{"start":{"row":230,"column":3},"end":{"row":230,"column":4},"action":"insert","lines":["r"]},{"start":{"row":230,"column":4},"end":{"row":230,"column":5},"action":"insert","lines":["o"]},{"start":{"row":230,"column":5},"end":{"row":230,"column":6},"action":"insert","lines":["i"]},{"start":{"row":230,"column":6},"end":{"row":230,"column":7},"action":"insert","lines":["n"]},{"start":{"row":230,"column":7},"end":{"row":230,"column":8},"action":"insert","lines":["o"]}],[{"start":{"row":230,"column":5},"end":{"row":230,"column":6},"action":"insert","lines":["r"],"id":125}],[{"start":{"row":230,"column":4},"end":{"row":230,"column":5},"action":"remove","lines":["o"],"id":126},{"start":{"row":230,"column":3},"end":{"row":230,"column":4},"action":"remove","lines":["r"]}],[{"start":{"row":230,"column":3},"end":{"row":230,"column":4},"action":"insert","lines":["o"],"id":127}],[{"start":{"row":283,"column":10},"end":{"row":284,"column":0},"action":"insert","lines":["",""],"id":128},{"start":{"row":284,"column":0},"end":{"row":284,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":37,"column":44},"end":{"row":37,"column":62},"action":"remove","lines":["the city of Torino"],"id":129}],[{"start":{"row":37,"column":44},"end":{"row":37,"column":45},"action":"insert","lines":["e"],"id":130},{"start":{"row":37,"column":45},"end":{"row":37,"column":46},"action":"insert","lines":["a"]},{"start":{"row":37,"column":46},"end":{"row":37,"column":47},"action":"insert","lines":["c"]},{"start":{"row":37,"column":47},"end":{"row":37,"column":48},"action":"insert","lines":["h"]}],[{"start":{"row":37,"column":48},"end":{"row":37,"column":49},"action":"insert","lines":[" "],"id":131},{"start":{"row":37,"column":49},"end":{"row":37,"column":50},"action":"insert","lines":["c"]},{"start":{"row":37,"column":50},"end":{"row":37,"column":51},"action":"insert","lines":["i"]},{"start":{"row":37,"column":51},"end":{"row":37,"column":52},"action":"insert","lines":["t"]},{"start":{"row":37,"column":52},"end":{"row":37,"column":53},"action":"insert","lines":["y"]}],[{"start":{"row":38,"column":0},"end":{"row":227,"column":22},"action":"remove","lines":["resTO = Bookings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"Torino\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeEU,","                                        \"$lt\": endUnixTimeEU","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"dayMonth\": {","                                    \"$dayOfMonth\": \"$init_date\"","                        },","                        \"moved\": {","                                    \"$ne\": [","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                                            ]","                                },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"moved\": True, #only the cars which have starting coordinates different from the final ones","                            \"duration\": { #only the durations higher than 3 minutes but lower than 180","                                            \"$gte\": 3,","                                            \"$lte\": 180","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id.day\":1,","                            \"_id.hour\": 1","                        }","            }","           ])","","resMA = Bookings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"Madrid\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeEU,","                                        \"$lt\": endUnixTimeEU","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"dayMonth\": {","                                    \"$dayOfMonth\": \"$init_date\"","                        },","                        \"moved\": {","                                    \"$ne\": [","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                                            ]","                                },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"moved\": True,","                            \"duration\": {","                                            \"$gte\": 3,","                                            \"$lte\": 180","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id.day\":1,","                            \"_id.hour\": 1","                        }","            }","           ])","","resNYC = Bookings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"New York City\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeNY,","                                        \"$lt\": endUnixTimeNY","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"dayMonth\": {","                                    \"$dayOfMonth\": \"$init_date\"","                        },","                        \"moved\": {","                                    \"$ne\": [","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                                            ]","                                },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"moved\": True,","                            \"duration\": {","                                            \"$gte\": 3,","                                            \"$lte\": 180","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id.day\":1,","                            \"_id.hour\": 1","                        }","            }","           ])","           ","# Extract booking data","listTO = list(resTO)","listMA = list(resMA)","listNYC = list(resNYC)"],"id":132},{"start":{"row":38,"column":0},"end":{"row":114,"column":27},"action":"insert","lines":["cities = [\"Torino\", \"Madrid\", \"New York City\"]","for city in cities:","    if city == \"Madrid\" or city == \"Torino\":","        startUnixTime = startUnixTimeEU","        endUnixTime = endUnixTimeEU","    else:","        startUnixTime = startUnixTimeNY","        endUnixTime = endUnixTimeNY","","    # Define query to extract database info for each city","    res = Bookings_collection.aggregate([{","        \"$match\":","            {","                \"city\": city,","                \"init_time\": {","                    \"$gte\": startUnixTime,","                    \"$lt\": endUnixTime","                },","            }","    },","        {","            \"$project\":","                {","                    \"_id\": 0,","                    \"init_time\": 1,","                    \"hourDay\": {","                        \"$hour\": \"$init_date\"","                    },","                    \"dayMonth\": {","                        \"$dayOfMonth\": \"$init_date\"","                    },","                    \"moved\": {","                        \"$ne\": [","                            {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                            {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                        ]","                    },","                    \"duration\": {","                        \"$ceil\": {","                            \"$divide\": [","                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                60","                            ]","                        }","                    }","                }","        },","        {","            \"$match\": {","                \"moved\": True,  # only the cars which have starting coordinates different from the final ones","                \"duration\": {  # only the durations higher than 3 minutes but lower than 180","                    \"$gte\": 3,","                    \"$lte\": 180","                }","            }","        },","        {","            \"$group\":","                {","                    \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                    \"count\": {\"$sum\": 1}","                }","        },","        {","            \"$sort\":","                {","                    \"_id.day\": 1,","                    \"_id.hour\": 1","                }","        }","    ])","    if city == \"Torino\":","        listTO = list(res)","    if city == \"Madrid\":","        listMA = list(res)","    if city == \"New York City\":","        listNYC = list(res)"]}],[{"start":{"row":108,"column":6},"end":{"row":109,"column":0},"action":"insert","lines":["",""],"id":133},{"start":{"row":109,"column":0},"end":{"row":109,"column":4},"action":"insert","lines":["    "]},{"start":{"row":109,"column":4},"end":{"row":109,"column":5},"action":"insert","lines":["#"]}],[{"start":{"row":109,"column":5},"end":{"row":109,"column":6},"action":"insert","lines":[" "],"id":134},{"start":{"row":109,"column":6},"end":{"row":109,"column":7},"action":"insert","lines":["E"]},{"start":{"row":109,"column":7},"end":{"row":109,"column":8},"action":"insert","lines":["x"]},{"start":{"row":109,"column":8},"end":{"row":109,"column":9},"action":"insert","lines":["t"]},{"start":{"row":109,"column":9},"end":{"row":109,"column":10},"action":"insert","lines":["r"]},{"start":{"row":109,"column":10},"end":{"row":109,"column":11},"action":"insert","lines":["a"]}],[{"start":{"row":109,"column":11},"end":{"row":109,"column":12},"action":"insert","lines":["c"],"id":135},{"start":{"row":109,"column":12},"end":{"row":109,"column":13},"action":"insert","lines":["t"]}],[{"start":{"row":109,"column":13},"end":{"row":109,"column":14},"action":"insert","lines":[" "],"id":136},{"start":{"row":109,"column":14},"end":{"row":109,"column":15},"action":"insert","lines":["t"]},{"start":{"row":109,"column":15},"end":{"row":109,"column":16},"action":"insert","lines":["h"]},{"start":{"row":109,"column":16},"end":{"row":109,"column":17},"action":"insert","lines":["e"]}],[{"start":{"row":109,"column":17},"end":{"row":109,"column":18},"action":"insert","lines":[" "],"id":137},{"start":{"row":109,"column":18},"end":{"row":109,"column":19},"action":"insert","lines":["b"]},{"start":{"row":109,"column":19},"end":{"row":109,"column":20},"action":"insert","lines":["o"]},{"start":{"row":109,"column":20},"end":{"row":109,"column":21},"action":"insert","lines":["o"]},{"start":{"row":109,"column":21},"end":{"row":109,"column":22},"action":"insert","lines":["k"]},{"start":{"row":109,"column":22},"end":{"row":109,"column":23},"action":"insert","lines":["i"]},{"start":{"row":109,"column":23},"end":{"row":109,"column":24},"action":"insert","lines":["n"]},{"start":{"row":109,"column":24},"end":{"row":109,"column":25},"action":"insert","lines":["g"]}],[{"start":{"row":109,"column":25},"end":{"row":109,"column":26},"action":"insert","lines":[" "],"id":138},{"start":{"row":109,"column":26},"end":{"row":109,"column":27},"action":"insert","lines":["i"]},{"start":{"row":109,"column":27},"end":{"row":109,"column":28},"action":"insert","lines":["n"]},{"start":{"row":109,"column":28},"end":{"row":109,"column":29},"action":"insert","lines":["f"]},{"start":{"row":109,"column":29},"end":{"row":109,"column":30},"action":"insert","lines":["o"]}],[{"start":{"row":109,"column":30},"end":{"row":109,"column":31},"action":"insert","lines":[" "],"id":139},{"start":{"row":109,"column":31},"end":{"row":109,"column":32},"action":"insert","lines":["f"]},{"start":{"row":109,"column":32},"end":{"row":109,"column":33},"action":"insert","lines":["r"]},{"start":{"row":109,"column":33},"end":{"row":109,"column":34},"action":"insert","lines":["o"]},{"start":{"row":109,"column":34},"end":{"row":109,"column":35},"action":"insert","lines":["m"]}],[{"start":{"row":109,"column":35},"end":{"row":109,"column":36},"action":"insert","lines":[" "],"id":140},{"start":{"row":109,"column":36},"end":{"row":109,"column":37},"action":"insert","lines":["t"]},{"start":{"row":109,"column":37},"end":{"row":109,"column":38},"action":"insert","lines":["h"]},{"start":{"row":109,"column":38},"end":{"row":109,"column":39},"action":"insert","lines":["e"]}],[{"start":{"row":109,"column":39},"end":{"row":109,"column":40},"action":"insert","lines":[" "],"id":141}],[{"start":{"row":109,"column":31},"end":{"row":109,"column":40},"action":"remove","lines":["from the "],"id":142},{"start":{"row":109,"column":30},"end":{"row":109,"column":31},"action":"remove","lines":[" "]},{"start":{"row":109,"column":29},"end":{"row":109,"column":30},"action":"remove","lines":["o"]},{"start":{"row":109,"column":28},"end":{"row":109,"column":29},"action":"remove","lines":["f"]},{"start":{"row":109,"column":27},"end":{"row":109,"column":28},"action":"remove","lines":["n"]},{"start":{"row":109,"column":26},"end":{"row":109,"column":27},"action":"remove","lines":["i"]}],[{"start":{"row":109,"column":26},"end":{"row":109,"column":27},"action":"insert","lines":["d"],"id":143},{"start":{"row":109,"column":27},"end":{"row":109,"column":28},"action":"insert","lines":["a"]},{"start":{"row":109,"column":28},"end":{"row":109,"column":29},"action":"insert","lines":["t"]},{"start":{"row":109,"column":29},"end":{"row":109,"column":30},"action":"insert","lines":["a"]}],[{"start":{"row":108,"column":6},"end":{"row":109,"column":0},"action":"insert","lines":["",""],"id":144},{"start":{"row":109,"column":0},"end":{"row":109,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":110,"column":30},"end":{"row":110,"column":31},"action":"insert","lines":[" "],"id":145},{"start":{"row":110,"column":31},"end":{"row":110,"column":32},"action":"insert","lines":["f"]},{"start":{"row":110,"column":32},"end":{"row":110,"column":33},"action":"insert","lines":["o"]},{"start":{"row":110,"column":33},"end":{"row":110,"column":34},"action":"insert","lines":["r"]}],[{"start":{"row":110,"column":34},"end":{"row":110,"column":35},"action":"insert","lines":[" "],"id":146},{"start":{"row":110,"column":35},"end":{"row":110,"column":36},"action":"insert","lines":["e"]},{"start":{"row":110,"column":36},"end":{"row":110,"column":37},"action":"insert","lines":["a"]},{"start":{"row":110,"column":37},"end":{"row":110,"column":38},"action":"insert","lines":["c"]},{"start":{"row":110,"column":38},"end":{"row":110,"column":39},"action":"insert","lines":["h"]}],[{"start":{"row":110,"column":39},"end":{"row":110,"column":40},"action":"insert","lines":[" "],"id":147},{"start":{"row":110,"column":40},"end":{"row":110,"column":41},"action":"insert","lines":["c"]},{"start":{"row":110,"column":41},"end":{"row":110,"column":42},"action":"insert","lines":["i"]},{"start":{"row":110,"column":42},"end":{"row":110,"column":43},"action":"insert","lines":["t"]},{"start":{"row":110,"column":43},"end":{"row":110,"column":44},"action":"insert","lines":["y"]}],[{"start":{"row":37,"column":0},"end":{"row":37,"column":53},"action":"remove","lines":["# Define query to extract database info for each city"],"id":148}],[{"start":{"row":38,"column":46},"end":{"row":38,"column":47},"action":"insert","lines":[" "],"id":149}],[{"start":{"row":38,"column":47},"end":{"row":38,"column":71},"action":"insert","lines":["# Define cities to study"],"id":150}],[{"start":{"row":37,"column":0},"end":{"row":38,"column":71},"action":"remove","lines":["","cities = [\"Torino\", \"Madrid\", \"New York City\"] # Define cities to study"],"id":151}],[{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"remove","lines":["",""],"id":152}],[{"start":{"row":17,"column":0},"end":{"row":18,"column":71},"action":"insert","lines":["","cities = [\"Torino\", \"Madrid\", \"New York City\"] # Define cities to study"],"id":153}],[{"start":{"row":16,"column":84},"end":{"row":17,"column":0},"action":"remove","lines":["",""],"id":154}],[{"start":{"row":17,"column":71},"end":{"row":18,"column":0},"action":"insert","lines":["",""],"id":155}],[{"start":{"row":19,"column":64},"end":{"row":19,"column":65},"action":"remove","lines":["s"],"id":156}],[{"start":{"row":19,"column":64},"end":{"row":19,"column":65},"action":"insert","lines":["S"],"id":157}],[{"start":{"row":20,"column":62},"end":{"row":20,"column":63},"action":"remove","lines":["e"],"id":158}],[{"start":{"row":20,"column":62},"end":{"row":20,"column":63},"action":"insert","lines":["E"],"id":159}],[{"start":{"row":37,"column":0},"end":{"row":38,"column":0},"action":"insert","lines":["",""],"id":160},{"start":{"row":38,"column":0},"end":{"row":38,"column":1},"action":"insert","lines":["à"]}],[{"start":{"row":38,"column":0},"end":{"row":38,"column":1},"action":"remove","lines":["à"],"id":161}],[{"start":{"row":38,"column":0},"end":{"row":38,"column":1},"action":"insert","lines":["#"],"id":162}],[{"start":{"row":38,"column":1},"end":{"row":38,"column":2},"action":"insert","lines":[" "],"id":163},{"start":{"row":38,"column":2},"end":{"row":38,"column":3},"action":"insert","lines":["F"]},{"start":{"row":38,"column":3},"end":{"row":38,"column":4},"action":"insert","lines":["o"]},{"start":{"row":38,"column":4},"end":{"row":38,"column":5},"action":"insert","lines":["r"]}],[{"start":{"row":38,"column":5},"end":{"row":38,"column":6},"action":"insert","lines":[" "],"id":164},{"start":{"row":38,"column":6},"end":{"row":38,"column":7},"action":"insert","lines":["e"]},{"start":{"row":38,"column":7},"end":{"row":38,"column":8},"action":"insert","lines":["a"]},{"start":{"row":38,"column":8},"end":{"row":38,"column":9},"action":"insert","lines":["c"]},{"start":{"row":38,"column":9},"end":{"row":38,"column":10},"action":"insert","lines":["h"]}],[{"start":{"row":38,"column":10},"end":{"row":38,"column":11},"action":"insert","lines":[" "],"id":165},{"start":{"row":38,"column":11},"end":{"row":38,"column":12},"action":"insert","lines":["c"]},{"start":{"row":38,"column":12},"end":{"row":38,"column":13},"action":"insert","lines":["i"]},{"start":{"row":38,"column":13},"end":{"row":38,"column":14},"action":"insert","lines":["t"]},{"start":{"row":38,"column":14},"end":{"row":38,"column":15},"action":"insert","lines":["y"]}],[{"start":{"row":38,"column":15},"end":{"row":38,"column":16},"action":"insert","lines":[" "],"id":166},{"start":{"row":38,"column":16},"end":{"row":38,"column":17},"action":"insert","lines":["u"]},{"start":{"row":38,"column":17},"end":{"row":38,"column":18},"action":"insert","lines":["n"]},{"start":{"row":38,"column":18},"end":{"row":38,"column":19},"action":"insert","lines":["d"]},{"start":{"row":38,"column":19},"end":{"row":38,"column":20},"action":"insert","lines":["e"]},{"start":{"row":38,"column":20},"end":{"row":38,"column":21},"action":"insert","lines":["r"]}],[{"start":{"row":38,"column":21},"end":{"row":38,"column":22},"action":"insert","lines":[" "],"id":167},{"start":{"row":38,"column":22},"end":{"row":38,"column":23},"action":"insert","lines":["s"]},{"start":{"row":38,"column":23},"end":{"row":38,"column":24},"action":"insert","lines":["t"]},{"start":{"row":38,"column":24},"end":{"row":38,"column":25},"action":"insert","lines":["u"]},{"start":{"row":38,"column":25},"end":{"row":38,"column":26},"action":"insert","lines":["d"]},{"start":{"row":38,"column":26},"end":{"row":38,"column":27},"action":"insert","lines":["y"]}],[{"start":{"row":111,"column":0},"end":{"row":116,"column":27},"action":"remove","lines":["    if city == \"Torino\":","        listTO = list(res)","    if city == \"Madrid\":","        listMA = list(res)","    if city == \"New York City\":","        listNYC = list(res)"],"id":168},{"start":{"row":111,"column":0},"end":{"row":119,"column":30},"action":"insert","lines":["    if city == \"Torino\":","        listTO = list(resB)","        listP_TO = list(resP)","    if city == \"Madrid\":","        listMA = list(resB)","        listP_MA = list(resP)","    if city == \"New York City\":","        listNYC = list(resB)","        listP_NYC = list(resP)"]}],[{"start":{"row":112,"column":12},"end":{"row":112,"column":13},"action":"insert","lines":["B"],"id":169},{"start":{"row":112,"column":13},"end":{"row":112,"column":14},"action":"insert","lines":["_"]}],[{"start":{"row":115,"column":12},"end":{"row":115,"column":13},"action":"insert","lines":["B"],"id":170},{"start":{"row":115,"column":13},"end":{"row":115,"column":14},"action":"insert","lines":["_"]}],[{"start":{"row":118,"column":12},"end":{"row":118,"column":13},"action":"insert","lines":["B"],"id":171},{"start":{"row":118,"column":13},"end":{"row":118,"column":14},"action":"insert","lines":["_"]}],[{"start":{"row":124,"column":16},"end":{"row":124,"column":17},"action":"insert","lines":["B"],"id":172},{"start":{"row":124,"column":17},"end":{"row":124,"column":18},"action":"insert","lines":["_"]}],[{"start":{"row":137,"column":16},"end":{"row":137,"column":17},"action":"insert","lines":["B"],"id":173},{"start":{"row":137,"column":17},"end":{"row":137,"column":18},"action":"insert","lines":["_"]}],[{"start":{"row":150,"column":16},"end":{"row":150,"column":17},"action":"insert","lines":["B"],"id":174},{"start":{"row":150,"column":17},"end":{"row":150,"column":18},"action":"insert","lines":["_"]}],[{"start":{"row":109,"column":4},"end":{"row":110,"column":0},"action":"insert","lines":["",""],"id":175},{"start":{"row":110,"column":0},"end":{"row":110,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":48,"column":7},"end":{"row":48,"column":8},"action":"insert","lines":["B"],"id":176}],[{"start":{"row":109,"column":4},"end":{"row":110,"column":0},"action":"insert","lines":["",""],"id":177},{"start":{"row":110,"column":0},"end":{"row":110,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":110,"column":4},"end":{"row":163,"column":6},"action":"insert","lines":["","    resP = Parkings_collection.aggregate([{","        \"$match\":","            {","                \"city\": city,","                \"init_time\": {","                    \"$gte\": startUnixTime,","                    \"$lt\": endUnixTime","                },","            }","    },","        {","            \"$project\":","                {","                    \"_id\": 0,","                    \"init_time\": 1,","                    \"hourDay\": {","                        \"$hour\": \"$init_date\"","                    },","                    \"dayMonth\": {","                        \"$dayOfMonth\": \"$init_date\"","                    },","                    \"duration\": {","                        \"$ceil\": {","                            \"$divide\": [","                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                60","                            ]","                        }","                    }","                }","        },","        {","            \"$match\": {","                \"duration\": {  # only the duration that last more than 2 minutes","                    \"$gte\": 2","                }","            }","        },","        {","            \"$group\":","                {","                    \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                    \"count\": {\"$sum\": 1}","                }","        },","        {","            \"$sort\":","                {","                    \"_id.day\": 1,","                    \"_id.hour\": 1","                }","        }","    ])"],"id":178}],[{"start":{"row":110,"column":0},"end":{"row":110,"column":4},"action":"remove","lines":["    "],"id":179},{"start":{"row":109,"column":4},"end":{"row":110,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":230,"column":0},"end":{"row":285,"column":24},"action":"remove","lines":["#","resP_TO = Parkings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"Torino\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeEU,","                                        \"$lt\": endUnixTimeEU","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"dayMonth\": {","                                    \"$dayOfMonth\": \"$init_date\"","                        },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"duration\": { # only the duration that last more than 2 minutes","                                            \"$gte\": 2","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id.day\":1,","                            \"_id.hour\": 1","                        }","            }","           ])","","listP_TO = list(resP_TO)"],"id":180}],[{"start":{"row":243,"column":0},"end":{"row":295,"column":13},"action":"remove","lines":["resP_MA = Parkings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"Madrid\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeEU,","                                        \"$lt\": endUnixTimeEU","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"dayMonth\": {","                                    \"$dayOfMonth\": \"$init_date\"","                        },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"duration\": {","                                            \"$gte\": 2","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id.day\":1,","                            \"_id.hour\": 1","                        }","            }","           ])"],"id":181},{"start":{"row":242,"column":0},"end":{"row":243,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":243,"column":0},"end":{"row":244,"column":24},"action":"remove","lines":["","listP_MA = list(resP_MA)"],"id":182},{"start":{"row":242,"column":0},"end":{"row":243,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":255,"column":0},"end":{"row":309,"column":26},"action":"remove","lines":["resP_NYC = Parkings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"New York City\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeNY,","                                        \"$lt\": endUnixTimeNY","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"dayMonth\": {","                                    \"$dayOfMonth\": \"$init_date\"","                        },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"duration\": {","                                            \"$gte\": 2","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"day\": \"$dayMonth\", \"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id.day\":1,","                            \"_id.hour\": 1","                        }","            }","           ])","","listP_NYC = list(resP_NYC)"],"id":183}],[{"start":{"row":254,"column":0},"end":{"row":255,"column":0},"action":"remove","lines":["",""],"id":184}],[{"start":{"row":230,"column":0},"end":{"row":230,"column":1},"action":"insert","lines":["#"],"id":185}],[{"start":{"row":230,"column":1},"end":{"row":230,"column":2},"action":"insert","lines":[" "],"id":186}],[{"start":{"row":230,"column":2},"end":{"row":230,"column":111},"action":"insert","lines":["# Create dict for each city in which the keys are the days and the values are the number of bookings per hour"],"id":187}],[{"start":{"row":230,"column":3},"end":{"row":230,"column":4},"action":"remove","lines":[" "],"id":188},{"start":{"row":230,"column":2},"end":{"row":230,"column":3},"action":"remove","lines":["#"]}],[{"start":{"row":230,"column":91},"end":{"row":230,"column":95},"action":"remove","lines":[" boo"],"id":189},{"start":{"row":230,"column":91},"end":{"row":230,"column":92},"action":"insert","lines":["p"]},{"start":{"row":230,"column":92},"end":{"row":230,"column":93},"action":"insert","lines":["a"]},{"start":{"row":230,"column":93},"end":{"row":230,"column":94},"action":"insert","lines":["r"]}],[{"start":{"row":230,"column":91},"end":{"row":230,"column":92},"action":"insert","lines":[" "],"id":190}],[{"start":{"row":230,"column":109},"end":{"row":231,"column":0},"action":"insert","lines":["",""],"id":191},{"start":{"row":231,"column":0},"end":{"row":231,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":231,"column":1},"end":{"row":231,"column":2},"action":"insert","lines":[" "],"id":192},{"start":{"row":231,"column":2},"end":{"row":231,"column":3},"action":"insert","lines":["T"]},{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"insert","lines":["r"]},{"start":{"row":231,"column":4},"end":{"row":231,"column":5},"action":"insert","lines":["o"]},{"start":{"row":231,"column":5},"end":{"row":231,"column":6},"action":"insert","lines":["i"]},{"start":{"row":231,"column":6},"end":{"row":231,"column":7},"action":"insert","lines":["n"]}],[{"start":{"row":231,"column":6},"end":{"row":231,"column":7},"action":"remove","lines":["n"],"id":193},{"start":{"row":231,"column":5},"end":{"row":231,"column":6},"action":"remove","lines":["i"]},{"start":{"row":231,"column":4},"end":{"row":231,"column":5},"action":"remove","lines":["o"]},{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"remove","lines":["r"]}],[{"start":{"row":231,"column":3},"end":{"row":231,"column":4},"action":"insert","lines":["o"],"id":194},{"start":{"row":231,"column":4},"end":{"row":231,"column":5},"action":"insert","lines":["r"]},{"start":{"row":231,"column":5},"end":{"row":231,"column":6},"action":"insert","lines":["i"]},{"start":{"row":231,"column":6},"end":{"row":231,"column":7},"action":"insert","lines":["n"]},{"start":{"row":231,"column":7},"end":{"row":231,"column":8},"action":"insert","lines":["o"]}],[{"start":{"row":242,"column":46},"end":{"row":243,"column":0},"action":"insert","lines":["",""],"id":195},{"start":{"row":243,"column":0},"end":{"row":243,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":244,"column":0},"end":{"row":244,"column":1},"action":"insert","lines":["#"],"id":196}],[{"start":{"row":244,"column":1},"end":{"row":244,"column":2},"action":"insert","lines":[" "],"id":197},{"start":{"row":244,"column":2},"end":{"row":244,"column":3},"action":"insert","lines":["M"]},{"start":{"row":244,"column":3},"end":{"row":244,"column":4},"action":"insert","lines":["a"]},{"start":{"row":244,"column":4},"end":{"row":244,"column":5},"action":"insert","lines":["d"]},{"start":{"row":244,"column":5},"end":{"row":244,"column":6},"action":"insert","lines":["r"]},{"start":{"row":244,"column":6},"end":{"row":244,"column":7},"action":"insert","lines":["i"]},{"start":{"row":244,"column":7},"end":{"row":244,"column":8},"action":"insert","lines":["d"]}],[{"start":{"row":255,"column":46},"end":{"row":256,"column":0},"action":"remove","lines":["",""],"id":198}],[{"start":{"row":255,"column":46},"end":{"row":256,"column":0},"action":"insert","lines":["",""],"id":199},{"start":{"row":256,"column":0},"end":{"row":256,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":256,"column":4},"end":{"row":256,"column":8},"action":"remove","lines":["    "],"id":200},{"start":{"row":256,"column":0},"end":{"row":256,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":256,"column":0},"end":{"row":257,"column":0},"action":"insert","lines":["",""],"id":201},{"start":{"row":257,"column":0},"end":{"row":257,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":257,"column":1},"end":{"row":257,"column":2},"action":"insert","lines":[" "],"id":202},{"start":{"row":257,"column":2},"end":{"row":257,"column":3},"action":"insert","lines":["N"]},{"start":{"row":257,"column":3},"end":{"row":257,"column":4},"action":"insert","lines":["e"]},{"start":{"row":257,"column":4},"end":{"row":257,"column":5},"action":"insert","lines":["w"]}],[{"start":{"row":257,"column":5},"end":{"row":257,"column":6},"action":"insert","lines":[" "],"id":203},{"start":{"row":257,"column":6},"end":{"row":257,"column":7},"action":"insert","lines":["Y"]},{"start":{"row":257,"column":7},"end":{"row":257,"column":8},"action":"insert","lines":["o"]},{"start":{"row":257,"column":8},"end":{"row":257,"column":9},"action":"insert","lines":["r"]},{"start":{"row":257,"column":9},"end":{"row":257,"column":10},"action":"insert","lines":["k"]}],[{"start":{"row":257,"column":10},"end":{"row":257,"column":11},"action":"insert","lines":[" "],"id":204},{"start":{"row":257,"column":11},"end":{"row":257,"column":12},"action":"insert","lines":["C"]},{"start":{"row":257,"column":12},"end":{"row":257,"column":13},"action":"insert","lines":["I"]},{"start":{"row":257,"column":13},"end":{"row":257,"column":14},"action":"insert","lines":["t"]},{"start":{"row":257,"column":14},"end":{"row":257,"column":15},"action":"insert","lines":["y"]}],[{"start":{"row":257,"column":12},"end":{"row":257,"column":13},"action":"remove","lines":["I"],"id":205}],[{"start":{"row":257,"column":12},"end":{"row":257,"column":13},"action":"insert","lines":["i"],"id":206}]]},"timestamp":1605343533088}