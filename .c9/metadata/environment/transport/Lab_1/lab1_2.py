{"filter":false,"title":"lab1_2.py","tooltip":"/transport/Lab_1/lab1_2.py","ace":{"folds":[{"start":{"row":40,"column":29},"end":{"row":64,"column":20},"placeholder":"..."},{"start":{"row":66,"column":29},"end":{"row":90,"column":20},"placeholder":"..."},{"start":{"row":161,"column":45},"end":{"row":170,"column":12},"placeholder":"..."},{"start":{"row":171,"column":13},"end":{"row":194,"column":12},"placeholder":"..."},{"start":{"row":195,"column":13},"end":{"row":203,"column":12},"placeholder":"..."},{"start":{"row":204,"column":13},"end":{"row":210,"column":12},"placeholder":"..."},{"start":{"row":211,"column":13},"end":{"row":216,"column":12},"placeholder":"..."},{"start":{"row":218,"column":45},"end":{"row":227,"column":12},"placeholder":"..."},{"start":{"row":228,"column":13},"end":{"row":251,"column":12},"placeholder":"..."},{"start":{"row":252,"column":13},"end":{"row":260,"column":12},"placeholder":"..."},{"start":{"row":261,"column":13},"end":{"row":267,"column":12},"placeholder":"..."},{"start":{"row":268,"column":13},"end":{"row":273,"column":12},"placeholder":"..."},{"start":{"row":275,"column":45},"end":{"row":284,"column":12},"placeholder":"..."},{"start":{"row":285,"column":13},"end":{"row":308,"column":12},"placeholder":"..."},{"start":{"row":309,"column":13},"end":{"row":317,"column":12},"placeholder":"..."},{"start":{"row":318,"column":13},"end":{"row":324,"column":12},"placeholder":"..."},{"start":{"row":325,"column":13},"end":{"row":330,"column":12},"placeholder":"..."}],"scrolltop":2010.5,"scrollleft":0,"selection":{"start":{"row":92,"column":16},"end":{"row":92,"column":16},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":311,"state":"start","mode":"ace/mode/python"}},"hash":"4db9f79b65c1ff74cd315e0dbdb1c796dbefde00","undoManager":{"mark":36,"position":36,"stack":[[{"start":{"row":0,"column":0},"end":{"row":141,"column":0},"action":"insert","lines":["import pymongo as pm  # import MongoClient only","import matplotlib","import pandas","import pprint","import numpy as np","import matplotlib.pyplot as plt","from datetime import date, datetime, timezone","client = pm.MongoClient('bigdatadb.polito.it', ssl=True,","                        authSource='carsharing', tlsAllowInvalidCertificates=True)","db = client['carsharing']  # Choose the DB to use","# , mechanism='MONGODB-CR') #authentication","db.authenticate('ictts', 'Ictts16!')","","cities = ['Torino','New York City', 'Madrid']","Bookings_collection = db['PermanentBookings']  # Booking Collection for Car2go to use","Parkings_collection = db['PermanentParkings'] # Parking Collection for Car2go to use","","startUnixTime_datetime = (datetime(2017, 11, 1, tzinfo=timezone.utc))","startUnixTime = startUnixTime_datetime.timestamp()","endUnixTime_datetime = (datetime(2017, 11, 30, tzinfo=timezone.utc))","endUnixTime = endUnixTime_datetime.timestamp()","","","# Define pipeline to extract database info","pipeline_Torino = [{\"$match\":","                    {","                        \"city\": \"Torino\",","                        \"init_time\": {\"$gte\": startUnixTime, \"$lte\": endUnixTime},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","pipeline_Madrid = [{\"$match\":","                    {","                        \"city\": \"Madrid\",","                        \"init_time\": {\"$gte\": startUnixTime, \"$lte\": endUnixTime},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","pipeline_NYC = [","                    {\"$match\":","                    {","                        \"city\": \"New York City\",","                        \"init_time\": {\"$gte\": startUnixTime, \"$lte\": endUnixTime},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","# Extract booking data","book_res_NY =list(Bookings_collection.aggregate(pipeline_NYC))","book_res_TO = list(Bookings_collection.aggregate(pipeline_Torino))","book_res_MA = list(Bookings_collection.aggregate(pipeline_Madrid))","","#Extract parking data","park_res_TO = list(Parkings_collection.aggregate(pipeline_Torino))","park_res_NY =list(Parkings_collection.aggregate(pipeline_NYC))","park_res_MA = list(Parkings_collection.aggregate(pipeline_Madrid))","","#Plot the booking over day","def plotDistr(x,y,label):","    plt.bar(x,y,label=label) ","","","plotDistr([x[\"_id\"][\"hour\"] for x in book_res_TO],[y[\"count\"] for y in book_res_TO],\"Torino\")","plotDistr([x[\"_id\"][\"hour\"] for x in book_res_NY],[y[\"count\"] for y in book_res_NY],\"New York City\")","plotDistr([x[\"_id\"][\"hour\"] for x in book_res_MA],[y[\"count\"] for y in book_res_MA],\"Madrid\")","","","plt.title(\"Distribution of booking over day\")","plt.xlabel(\"hour\")","plt.ylabel(\"n rental\")","plt.legend()","plt.show()","","","plotDistr([x[\"_id\"][\"hour\"] for x in park_res_MA],[y[\"count\"] for y in park_res_MA],\"Madrid\")","plotDistr([x[\"_id\"][\"hour\"] for x in park_res_NY],[y[\"count\"] for y in park_res_NY],\"New York City\")","plotDistr([x[\"_id\"][\"hour\"] for x in park_res_TO],[y[\"count\"] for y in park_res_TO],\"Torino\")","","","plt.title(\"Distribution of parking over day\")","plt.xlabel(\"hour\")","plt.ylabel(\"n park\")","plt.legend()","plt.show()","",""],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":141,"column":0},"action":"remove","lines":["import pymongo as pm  # import MongoClient only","import matplotlib","import pandas","import pprint","import numpy as np","import matplotlib.pyplot as plt","from datetime import date, datetime, timezone","client = pm.MongoClient('bigdatadb.polito.it', ssl=True,","                        authSource='carsharing', tlsAllowInvalidCertificates=True)","db = client['carsharing']  # Choose the DB to use","# , mechanism='MONGODB-CR') #authentication","db.authenticate('ictts', 'Ictts16!')","","cities = ['Torino','New York City', 'Madrid']","Bookings_collection = db['PermanentBookings']  # Booking Collection for Car2go to use","Parkings_collection = db['PermanentParkings'] # Parking Collection for Car2go to use","","startUnixTime_datetime = (datetime(2017, 11, 1, tzinfo=timezone.utc))","startUnixTime = startUnixTime_datetime.timestamp()","endUnixTime_datetime = (datetime(2017, 11, 30, tzinfo=timezone.utc))","endUnixTime = endUnixTime_datetime.timestamp()","","","# Define pipeline to extract database info","pipeline_Torino = [{\"$match\":","                    {","                        \"city\": \"Torino\",","                        \"init_time\": {\"$gte\": startUnixTime, \"$lte\": endUnixTime},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","pipeline_Madrid = [{\"$match\":","                    {","                        \"city\": \"Madrid\",","                        \"init_time\": {\"$gte\": startUnixTime, \"$lte\": endUnixTime},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","pipeline_NYC = [","                    {\"$match\":","                    {","                        \"city\": \"New York City\",","                        \"init_time\": {\"$gte\": startUnixTime, \"$lte\": endUnixTime},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","# Extract booking data","book_res_NY =list(Bookings_collection.aggregate(pipeline_NYC))","book_res_TO = list(Bookings_collection.aggregate(pipeline_Torino))","book_res_MA = list(Bookings_collection.aggregate(pipeline_Madrid))","","#Extract parking data","park_res_TO = list(Parkings_collection.aggregate(pipeline_Torino))","park_res_NY =list(Parkings_collection.aggregate(pipeline_NYC))","park_res_MA = list(Parkings_collection.aggregate(pipeline_Madrid))","","#Plot the booking over day","def plotDistr(x,y,label):","    plt.bar(x,y,label=label) ","","","plotDistr([x[\"_id\"][\"hour\"] for x in book_res_TO],[y[\"count\"] for y in book_res_TO],\"Torino\")","plotDistr([x[\"_id\"][\"hour\"] for x in book_res_NY],[y[\"count\"] for y in book_res_NY],\"New York City\")","plotDistr([x[\"_id\"][\"hour\"] for x in book_res_MA],[y[\"count\"] for y in book_res_MA],\"Madrid\")","","","plt.title(\"Distribution of booking over day\")","plt.xlabel(\"hour\")","plt.ylabel(\"n rental\")","plt.legend()","plt.show()","","","plotDistr([x[\"_id\"][\"hour\"] for x in park_res_MA],[y[\"count\"] for y in park_res_MA],\"Madrid\")","plotDistr([x[\"_id\"][\"hour\"] for x in park_res_NY],[y[\"count\"] for y in park_res_NY],\"New York City\")","plotDistr([x[\"_id\"][\"hour\"] for x in park_res_TO],[y[\"count\"] for y in park_res_TO],\"Torino\")","","","plt.title(\"Distribution of parking over day\")","plt.xlabel(\"hour\")","plt.ylabel(\"n park\")","plt.legend()","plt.show()","",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":368,"column":10},"action":"insert","lines":["import pymongo as pm  # import MongoClient only","import matplotlib","import pandas","import pprint","import numpy as np","import pytz","import matplotlib.pyplot as plt","from datetime import date, datetime, timezone","client = pm.MongoClient('bigdatadb.polito.it', ssl=True,","                        authSource='carsharing', tlsAllowInvalidCertificates=True)","db = client['carsharing']  # Choose the DB to use","# , mechanism='MONGODB-CR') #authentication","db.authenticate('ictts', 'Ictts16!')","","cities = ['Torino','New York City', 'Madrid']","Bookings_collection = db['PermanentBookings']  # Booking Collection for Car2go to use","Parkings_collection = db['PermanentParkings'] # Parking Collection for Car2go to use","","startUnixTime_datetime = (datetime(2017, 11, 1, tzinfo=None))","endUnixTime_datetime = (datetime(2017, 12, 1, tzinfo=None))","","eu= pytz.timezone('Europe/Rome')","est=pytz.timezone('America/New_York')","","# Localize in Torino/Madrid","startUnixTime_datetimeEU = eu.localize(startUnixTime_datetime)","startUnixTimeEU = startUnixTime_datetimeEU.timestamp()","endUnixTime_datetimeEU = eu.localize(endUnixTime_datetime)","endUnixTimeEU = endUnixTime_datetimeEU.timestamp()","","#Localize in NYC","startUnixTime_datetimeNY = est.localize(startUnixTime_datetime)","startUnixTimeNY = startUnixTime_datetimeNY.timestamp()","endUnixTime_datetimeNY = est.localize(endUnixTime_datetime)","endUnixTimeNY = endUnixTime_datetimeNY.timestamp()","","# Define pipeline to extract database info","pipeline_Torino = [{\"$match\":","                    {","                        \"city\": \"Torino\",","                        \"init_time\": {\"$gte\": startUnixTimeEU, \"$lte\": endUnixTimeEU},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","pipeline_Madrid = [{\"$match\":","                    {","                        \"city\": \"Madrid\",","                        \"init_time\": {\"$gte\": startUnixTimeEU, \"$lte\": endUnixTimeEU},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","pipeline_NYC = [","                    {\"$match\":","                    {","                        \"city\": \"New York City\",","                        \"init_time\": {\"$gte\": startUnixTimeNY, \"$lte\": endUnixTimeNY},","                        # \"final_time\": {","                            # \"$gte\": startUnixTime, \"$lte\": endUnixTime}","                    }","                    },","                   {\"$project\":","                    {","                        \"city\": \"$city\",","                        \"hour\": {\"$hour\":\"$init_date\"}","                    }","                    },","                   {\"$group\":","                    {","","                        \"_id\": {\"city\": \"$city\", \"hour\": \"$hour\"},","                        \"count\": {\"$sum\": 1}","                    }","                    },","                   {\"$sort\":","                    {\"_id\": 1}","                    }","                   ]","","# Extract booking data","book_res_NY =list(Bookings_collection.aggregate(pipeline_NYC))","book_res_TO = list(Bookings_collection.aggregate(pipeline_Torino))","book_res_MA = list(Bookings_collection.aggregate(pipeline_Madrid))","","#Extract parking data","park_res_TO = list(Parkings_collection.aggregate(pipeline_Torino))","park_res_NY =list(Parkings_collection.aggregate(pipeline_NYC))","park_res_MA = list(Parkings_collection.aggregate(pipeline_Madrid))","","#Plot the booking over day","# def plotDistr(x,y,label):","    # plt.bar(x,y,label=label) ","","","# plotDistr([x[\"_id\"][\"hour\"] for x in book_res_TO],[y[\"count\"] for y in book_res_TO],\"Torino\")","# plotDistr([x[\"_id\"][\"hour\"] for x in book_res_NY],[y[\"count\"] for y in book_res_NY],\"New York City\")","# plotDistr([x[\"_id\"][\"hour\"] for x in book_res_MA],[y[\"count\"] for y in book_res_MA],\"Madrid\")","","","# plt.title(\"Distribution of booking over day\")","# plt.xlabel(\"hour\")","# plt.ylabel(\"n rental\")","# plt.legend()","# plt.show()","","","# plotDistr([x[\"_id\"][\"hour\"] for x in park_res_MA],[y[\"count\"] for y in park_res_MA],\"Madrid\")","# plotDistr([x[\"_id\"][\"hour\"] for x in park_res_NY],[y[\"count\"] for y in park_res_NY],\"New York City\")","# plotDistr([x[\"_id\"][\"hour\"] for x in park_res_TO],[y[\"count\"] for y in park_res_TO],\"Torino\")","","","# plt.title(\"Distribution of parking over day\")","# plt.xlabel(\"hour\")","# plt.ylabel(\"n park\")","# plt.legend()","# plt.show()","","# fig = plt.figure()","# ax = fig.add_axes([0,0,1,1])","fig,ax=plt.subplots()","ax.bar([x[\"_id\"][\"hour\"]+0 for x in book_res_TO],[y[\"count\"] for y in book_res_TO], color = 'b',label=\"Torino\", width = 0.25)","ax.bar([x[\"_id\"][\"hour\"]-0.25 for x in book_res_NY],[y[\"count\"] for y in book_res_NY], color = 'y',label=\"New York City\", width = 0.25)","ax.bar([x[\"_id\"][\"hour\"]+0.25 for x in book_res_MA],[y[\"count\"] for y in book_res_MA], color = 'r',label=\"Madrid\", width = 0.25)","ax.legend(labels=['Torino', 'New York City','Madrid'])","ax.set_ylabel('Bookings')","ax.set_xlabel('Hour')","ax.set_title('Booking per hour vs time of day')","ax.set_xticks(list([x[\"_id\"][\"hour\"] for x in book_res_TO]))","ax.set_xticklabels([x[\"_id\"][\"hour\"] for x in book_res_TO])","ax.set_yticks(np.arange(0, max([y[\"count\"] for y in book_res_MA]), 1000))","","plt.show()","","fig,ax=plt.subplots()","ax.bar([x[\"_id\"][\"hour\"]+0 for x in park_res_TO],[y[\"count\"] for y in park_res_TO], color = 'b',label=\"Torino\", width = 0.25)","ax.bar([x[\"_id\"][\"hour\"]-0.25 for x in park_res_NY],[y[\"count\"] for y in park_res_NY], color = 'y',label=\"New York City\", width = 0.25)","ax.bar([x[\"_id\"][\"hour\"]+0.25 for x in park_res_MA],[y[\"count\"] for y in park_res_MA], color = 'r',label=\"Madrid\", width = 0.25)","ax.legend(labels=['Torino', 'New York City','Madrid'])","ax.set_ylabel('Parking')","ax.set_xlabel('Hour')","ax.set_title('Parking per hour vs time of day')","ax.set_xticks(list([x[\"_id\"][\"hour\"] for x in park_res_TO]))","ax.set_xticklabels([x[\"_id\"][\"hour\"] for x in park_res_TO])","ax.set_yticks(np.arange(0, max([y[\"count\"] for y in park_res_NY]), 1000))","","plt.show()","","resMA = list(Bookings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"Madrid\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeEU,","                                        \"$lt\": endUnixTimeEU","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"moved\": {","                                    \"$ne\": [","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                                            ]","                                },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"moved\": True,","                            \"duration\": {","                                            \"$gte\": 3,","                                            \"$lte\": 180","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id\": 1","                        }","            }","           ]))","resNY = list(Bookings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"New York City\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeNY,","                                        \"$lt\": endUnixTimeNY","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"moved\": {","                                    \"$ne\": [","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                                            ]","                                },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"moved\": True,","                            \"duration\": {","                                            \"$gte\": 3,","                                            \"$lte\": 180","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id\": 1","                        }","            }","           ]))","resTO = list(Bookings_collection.aggregate([{","                \"$match\":","                    {","                        \"city\": \"Torino\",","                        \"init_time\": {","                                        \"$gte\": startUnixTimeEU,","                                        \"$lt\": endUnixTimeEU","                                     },","                    }","            },","            {","                \"$project\":","                    {","                        \"_id\": 0,","                        \"init_time\" : 1,","                        \"hourDay\": {","                                    \"$hour\": \"$init_date\"","                        },","                        \"moved\": {","                                    \"$ne\": [","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 0]},","                                                {\"$arrayElemAt\": [\"$origin_destination.coordinates\", 1]}","                                            ]","                                },","                        \"duration\": {","                                        \"$ceil\": {","                                                    \"$divide\": [","                                                                {\"$subtract\": [\"$final_time\", \"$init_time\"]},","                                                                60","                                                                ]","                                                 }","                                    }","                    }","            },","            {","                \"$match\": {","                            \"moved\": True,","                            \"duration\": {","                                            \"$gte\": 3,","                                            \"$lte\": 180","                                        }","                          }","            },","            {","                \"$group\":","                    {","                        \"_id\": {\"hour\": \"$hourDay\"},","                        \"count\": {\"$sum\": 1}","                    }","            },","            {","                \"$sort\":","                        {","                            \"_id\": 1","                        }","            }","           ]))","           ","fig,ax=plt.subplots()","ax.bar([x[\"_id\"][\"hour\"]+0 for x in resTO],[y[\"count\"] for y in resTO], color = 'b',label=\"Torino\", width = 0.25)","ax.bar([x[\"_id\"][\"hour\"]-0.25 for x in resNY],[y[\"count\"] for y in resNY], color = 'y',label=\"New York City\", width = 0.25)","ax.bar([x[\"_id\"][\"hour\"]+0.25 for x in resMA],[y[\"count\"] for y in resMA], color = 'r',label=\"Madrid\", width = 0.25)","ax.legend(labels=['Torino', 'New York City','Madrid'])","ax.set_ylabel('Bookings')","ax.set_xlabel('Hour')","ax.set_title('Booking per hour vs time of day (filtered)')","ax.set_xticks(list([x[\"_id\"][\"hour\"] for x in book_res_TO]))","ax.set_xticklabels([x[\"_id\"][\"hour\"] for x in book_res_TO])","ax.set_yticks(np.arange(0, max([y[\"count\"] for y in book_res_MA]), 1000))","","plt.show()"]}],[{"start":{"row":7,"column":45},"end":{"row":8,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":8,"column":0},"end":{"row":9,"column":0},"action":"insert","lines":["",""]},{"start":{"row":9,"column":0},"end":{"row":9,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":9,"column":1},"end":{"row":9,"column":2},"action":"insert","lines":[" "],"id":4},{"start":{"row":9,"column":2},"end":{"row":9,"column":3},"action":"insert","lines":["I"]},{"start":{"row":9,"column":3},"end":{"row":9,"column":4},"action":"insert","lines":["n"]},{"start":{"row":9,"column":4},"end":{"row":9,"column":5},"action":"insert","lines":["s"]},{"start":{"row":9,"column":5},"end":{"row":9,"column":6},"action":"insert","lines":["t"]},{"start":{"row":9,"column":6},"end":{"row":9,"column":7},"action":"insert","lines":["a"]},{"start":{"row":9,"column":7},"end":{"row":9,"column":8},"action":"insert","lines":["n"]},{"start":{"row":9,"column":8},"end":{"row":9,"column":9},"action":"insert","lines":["t"]},{"start":{"row":9,"column":9},"end":{"row":9,"column":10},"action":"insert","lines":["i"]},{"start":{"row":9,"column":10},"end":{"row":9,"column":11},"action":"insert","lines":["a"]}],[{"start":{"row":9,"column":11},"end":{"row":9,"column":12},"action":"insert","lines":["t"],"id":5},{"start":{"row":9,"column":12},"end":{"row":9,"column":13},"action":"insert","lines":["e"]}],[{"start":{"row":9,"column":13},"end":{"row":9,"column":14},"action":"insert","lines":[" "],"id":6},{"start":{"row":9,"column":14},"end":{"row":9,"column":15},"action":"insert","lines":["C"]}],[{"start":{"row":9,"column":14},"end":{"row":9,"column":15},"action":"remove","lines":["C"],"id":7}],[{"start":{"row":9,"column":14},"end":{"row":9,"column":15},"action":"insert","lines":["c"],"id":8},{"start":{"row":9,"column":15},"end":{"row":9,"column":16},"action":"insert","lines":["l"]},{"start":{"row":9,"column":16},"end":{"row":9,"column":17},"action":"insert","lines":["i"]},{"start":{"row":9,"column":17},"end":{"row":9,"column":18},"action":"insert","lines":["i"]},{"start":{"row":9,"column":18},"end":{"row":9,"column":19},"action":"insert","lines":["e"]},{"start":{"row":9,"column":19},"end":{"row":9,"column":20},"action":"insert","lines":["n"]}],[{"start":{"row":9,"column":19},"end":{"row":9,"column":20},"action":"remove","lines":["n"],"id":9},{"start":{"row":9,"column":18},"end":{"row":9,"column":19},"action":"remove","lines":["e"]},{"start":{"row":9,"column":17},"end":{"row":9,"column":18},"action":"remove","lines":["i"]},{"start":{"row":9,"column":16},"end":{"row":9,"column":17},"action":"remove","lines":["i"]},{"start":{"row":9,"column":15},"end":{"row":9,"column":16},"action":"remove","lines":["l"]},{"start":{"row":9,"column":14},"end":{"row":9,"column":15},"action":"remove","lines":["c"]}],[{"start":{"row":9,"column":14},"end":{"row":9,"column":15},"action":"insert","lines":["m"],"id":10},{"start":{"row":9,"column":15},"end":{"row":9,"column":16},"action":"insert","lines":["o"]},{"start":{"row":9,"column":16},"end":{"row":9,"column":17},"action":"insert","lines":["n"]},{"start":{"row":9,"column":17},"end":{"row":9,"column":18},"action":"insert","lines":["g"]},{"start":{"row":9,"column":18},"end":{"row":9,"column":19},"action":"insert","lines":["o"]},{"start":{"row":9,"column":19},"end":{"row":9,"column":20},"action":"insert","lines":["d"]},{"start":{"row":9,"column":20},"end":{"row":9,"column":21},"action":"insert","lines":["b"]}],[{"start":{"row":9,"column":21},"end":{"row":9,"column":22},"action":"insert","lines":[" "],"id":11},{"start":{"row":9,"column":22},"end":{"row":9,"column":23},"action":"insert","lines":["c"]},{"start":{"row":9,"column":23},"end":{"row":9,"column":24},"action":"insert","lines":["l"]},{"start":{"row":9,"column":24},"end":{"row":9,"column":25},"action":"insert","lines":["i"]},{"start":{"row":9,"column":25},"end":{"row":9,"column":26},"action":"insert","lines":["e"]},{"start":{"row":9,"column":26},"end":{"row":9,"column":27},"action":"insert","lines":["n"]},{"start":{"row":9,"column":27},"end":{"row":9,"column":28},"action":"insert","lines":["t"]}],[{"start":{"row":16,"column":45},"end":{"row":16,"column":46},"action":"insert","lines":[" "],"id":12}],[{"start":{"row":16,"column":46},"end":{"row":16,"column":70},"action":"insert","lines":["# Define cities to study"],"id":13}],[{"start":{"row":22,"column":0},"end":{"row":23,"column":0},"action":"insert","lines":["",""],"id":14}],[{"start":{"row":23,"column":0},"end":{"row":24,"column":0},"action":"insert","lines":["# Instantiate timezone",""],"id":15}],[{"start":{"row":23,"column":22},"end":{"row":24,"column":0},"action":"remove","lines":["",""],"id":16}],[{"start":{"row":139,"column":0},"end":{"row":155,"column":12},"action":"remove","lines":["# plt.title(\"Distribution of booking over day\")","# plt.xlabel(\"hour\")","# plt.ylabel(\"n rental\")","# plt.legend()","# plt.show()","","","# plotDistr([x[\"_id\"][\"hour\"] for x in park_res_MA],[y[\"count\"] for y in park_res_MA],\"Madrid\")","# plotDistr([x[\"_id\"][\"hour\"] for x in park_res_NY],[y[\"count\"] for y in park_res_NY],\"New York City\")","# plotDistr([x[\"_id\"][\"hour\"] for x in park_res_TO],[y[\"count\"] for y in park_res_TO],\"Torino\")","","","# plt.title(\"Distribution of parking over day\")","# plt.xlabel(\"hour\")","# plt.ylabel(\"n park\")","# plt.legend()","# plt.show()"],"id":17}],[{"start":{"row":129,"column":0},"end":{"row":138,"column":0},"action":"remove","lines":["#Plot the booking over day","# def plotDistr(x,y,label):","    # plt.bar(x,y,label=label) ","","","# plotDistr([x[\"_id\"][\"hour\"] for x in book_res_TO],[y[\"count\"] for y in book_res_TO],\"Torino\")","# plotDistr([x[\"_id\"][\"hour\"] for x in book_res_NY],[y[\"count\"] for y in book_res_NY],\"New York City\")","# plotDistr([x[\"_id\"][\"hour\"] for x in book_res_MA],[y[\"count\"] for y in book_res_MA],\"Madrid\")","",""],"id":18},{"start":{"row":128,"column":0},"end":{"row":129,"column":0},"action":"remove","lines":["",""]},{"start":{"row":127,"column":66},"end":{"row":128,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":129,"column":0},"end":{"row":131,"column":30},"action":"remove","lines":["","# fig = plt.figure()","# ax = fig.add_axes([0,0,1,1])"],"id":19}],[{"start":{"row":129,"column":0},"end":{"row":130,"column":0},"action":"insert","lines":["",""],"id":20},{"start":{"row":130,"column":0},"end":{"row":130,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":130,"column":1},"end":{"row":130,"column":2},"action":"insert","lines":[" "],"id":21},{"start":{"row":130,"column":2},"end":{"row":130,"column":3},"action":"insert","lines":["P"]},{"start":{"row":130,"column":3},"end":{"row":130,"column":4},"action":"insert","lines":["l"]},{"start":{"row":130,"column":4},"end":{"row":130,"column":5},"action":"insert","lines":["o"]},{"start":{"row":130,"column":5},"end":{"row":130,"column":6},"action":"insert","lines":["t"]}],[{"start":{"row":130,"column":6},"end":{"row":130,"column":7},"action":"insert","lines":[" "],"id":22},{"start":{"row":130,"column":7},"end":{"row":130,"column":8},"action":"insert","lines":["b"]},{"start":{"row":130,"column":8},"end":{"row":130,"column":9},"action":"insert","lines":["o"]},{"start":{"row":130,"column":9},"end":{"row":130,"column":10},"action":"insert","lines":["o"]},{"start":{"row":130,"column":10},"end":{"row":130,"column":11},"action":"insert","lines":["k"]},{"start":{"row":130,"column":11},"end":{"row":130,"column":12},"action":"insert","lines":["i"]},{"start":{"row":130,"column":12},"end":{"row":130,"column":13},"action":"insert","lines":["n"]}],[{"start":{"row":130,"column":13},"end":{"row":130,"column":14},"action":"insert","lines":["g"],"id":23}],[{"start":{"row":130,"column":14},"end":{"row":130,"column":15},"action":"insert","lines":[" "],"id":24}],[{"start":{"row":130,"column":15},"end":{"row":130,"column":16},"action":"insert","lines":["f"],"id":25},{"start":{"row":130,"column":16},"end":{"row":130,"column":17},"action":"insert","lines":["o"]},{"start":{"row":130,"column":17},"end":{"row":130,"column":18},"action":"insert","lines":["r"]}],[{"start":{"row":130,"column":18},"end":{"row":130,"column":19},"action":"insert","lines":[" "],"id":26},{"start":{"row":130,"column":19},"end":{"row":130,"column":20},"action":"insert","lines":["e"]},{"start":{"row":130,"column":20},"end":{"row":130,"column":21},"action":"insert","lines":["a"]},{"start":{"row":130,"column":21},"end":{"row":130,"column":22},"action":"insert","lines":["c"]},{"start":{"row":130,"column":22},"end":{"row":130,"column":23},"action":"insert","lines":["h"]}],[{"start":{"row":130,"column":23},"end":{"row":130,"column":24},"action":"insert","lines":[" "],"id":27},{"start":{"row":130,"column":24},"end":{"row":130,"column":25},"action":"insert","lines":["c"]},{"start":{"row":130,"column":25},"end":{"row":130,"column":26},"action":"insert","lines":["i"]},{"start":{"row":130,"column":26},"end":{"row":130,"column":27},"action":"insert","lines":["t"]},{"start":{"row":130,"column":27},"end":{"row":130,"column":28},"action":"insert","lines":["y"]}],[{"start":{"row":130,"column":28},"end":{"row":130,"column":29},"action":"insert","lines":[" "],"id":28},{"start":{"row":130,"column":29},"end":{"row":130,"column":30},"action":"insert","lines":["p"]},{"start":{"row":130,"column":30},"end":{"row":130,"column":31},"action":"insert","lines":["e"]},{"start":{"row":130,"column":31},"end":{"row":130,"column":32},"action":"insert","lines":["r"]}],[{"start":{"row":130,"column":32},"end":{"row":130,"column":33},"action":"insert","lines":[" "],"id":29}],[{"start":{"row":130,"column":33},"end":{"row":130,"column":34},"action":"insert","lines":["h"],"id":30},{"start":{"row":130,"column":34},"end":{"row":130,"column":35},"action":"insert","lines":["o"]},{"start":{"row":130,"column":35},"end":{"row":130,"column":36},"action":"insert","lines":["u"]},{"start":{"row":130,"column":36},"end":{"row":130,"column":37},"action":"insert","lines":["r"]}],[{"start":{"row":130,"column":37},"end":{"row":130,"column":38},"action":"insert","lines":[" "],"id":31},{"start":{"row":130,"column":38},"end":{"row":130,"column":39},"action":"insert","lines":["o"]},{"start":{"row":130,"column":39},"end":{"row":130,"column":40},"action":"insert","lines":["f"]}],[{"start":{"row":130,"column":40},"end":{"row":130,"column":41},"action":"insert","lines":[" "],"id":32},{"start":{"row":130,"column":41},"end":{"row":130,"column":42},"action":"insert","lines":["t"]},{"start":{"row":130,"column":42},"end":{"row":130,"column":43},"action":"insert","lines":["h"]},{"start":{"row":130,"column":43},"end":{"row":130,"column":44},"action":"insert","lines":["e"]}],[{"start":{"row":130,"column":44},"end":{"row":130,"column":45},"action":"insert","lines":[" "],"id":33},{"start":{"row":130,"column":45},"end":{"row":130,"column":46},"action":"insert","lines":["d"]},{"start":{"row":130,"column":46},"end":{"row":130,"column":47},"action":"insert","lines":["a"]},{"start":{"row":130,"column":47},"end":{"row":130,"column":48},"action":"insert","lines":["y"]}],[{"start":{"row":145,"column":0},"end":{"row":146,"column":0},"action":"insert","lines":["# Plot booking for each city per hour of the day",""],"id":34}],[{"start":{"row":145,"column":7},"end":{"row":145,"column":14},"action":"remove","lines":["booking"],"id":35},{"start":{"row":145,"column":7},"end":{"row":145,"column":8},"action":"insert","lines":["p"]},{"start":{"row":145,"column":8},"end":{"row":145,"column":9},"action":"insert","lines":["a"]},{"start":{"row":145,"column":9},"end":{"row":145,"column":10},"action":"insert","lines":["r"]},{"start":{"row":145,"column":10},"end":{"row":145,"column":11},"action":"insert","lines":["k"]},{"start":{"row":145,"column":11},"end":{"row":145,"column":12},"action":"insert","lines":["i"]},{"start":{"row":145,"column":12},"end":{"row":145,"column":13},"action":"insert","lines":["n"]},{"start":{"row":145,"column":13},"end":{"row":145,"column":14},"action":"insert","lines":["g"]}],[{"start":{"row":159,"column":0},"end":{"row":160,"column":0},"action":"insert","lines":["",""],"id":36},{"start":{"row":160,"column":0},"end":{"row":160,"column":1},"action":"insert","lines":["#"]}],[{"start":{"row":160,"column":1},"end":{"row":160,"column":2},"action":"insert","lines":[" "],"id":37},{"start":{"row":160,"column":2},"end":{"row":160,"column":3},"action":"insert","lines":["F"]},{"start":{"row":160,"column":3},"end":{"row":160,"column":4},"action":"insert","lines":["I"]},{"start":{"row":160,"column":4},"end":{"row":160,"column":5},"action":"insert","lines":["L"]},{"start":{"row":160,"column":5},"end":{"row":160,"column":6},"action":"insert","lines":["T"]},{"start":{"row":160,"column":6},"end":{"row":160,"column":7},"action":"insert","lines":["E"]},{"start":{"row":160,"column":7},"end":{"row":160,"column":8},"action":"insert","lines":["R"]}]]},"timestamp":1605293414703}